import greenfoot.*;

public class Stage2_Arena extends World {
    // Ukuran disesuaikan dengan gambar Arena.jpg (perkiraan)
    private static final int LEBAR = 1024;
    private static final int TINGGI = 576;
    
    // Variabel untuk UI
    private int score;

    public Stage2_Arena() {
        super(LEBAR, TINGGI, 1);
        
        // Siapkan background dengan metode scaling agar pas
        GreenfootImage background = new GreenfootImage("Arena.jpg");
        background.scale(getWidth(), getHeight());
        setBackground(background);
        
        // Panggil metode untuk menata level dan UI
        tataLevel();
        siapkanUI();
        
        setPaintOrder(Knight.class, Musuh.class, Portal.class, Platform.class);
    }
    
    /**
     * Metode untuk menata semua platform, karakter, dan musuh.
     */
    private void tataLevel() {
        // Tempatkan platform tak terlihat sesuai dengan gambar Arena.jpg
        
        // Lantai dasar
        addObject(new Platform(LEBAR, 20), LEBAR / 2, 545);
        
        // Pijakan di atas bangunan tengah (arena utama)
        addObject(new Platform(280, 20), 600, 500); // Lantai tengah
        addObject(new Platform(200, 20), 600, 300); // Balkon atas (tujuan)
        
        // Pijakan di sisi kiri
        addObject(new Platform(150, 20), 180, 400);
        
        // Pijakan di sisi kanan
        addObject(new Platform(150, 20), 1020, 400);
        
        // Tempatkan Knight di awal level (misal di kiri bawah)
        addObject(new Knight(), 100, 500);
        
        // Tempatkan beberapa musuh di lokasi yang menantang
        addObject(new Musuh(), 1000, 365); // Musuh di platform kanan
        addObject(new Musuh(), 600, 465);  // Musuh di lantai tengah arena
        
        // Tempatkan Portal tujuan di balkon tertinggi
        addObject(new Portal(), 600, 250);
    }
    
    /**
     * Metode untuk menyiapkan tampilan UI awal.
     */
    private void siapkanUI() {
        // Tampilkan nama stage di pojok kiri atas
        showText("Stage 2: Arena Ujian", 150, 30);
        
        // Atur skor awal dan tampilkan
        score = 0;
        updateScoreDisplay();
    }
    
    /**
     * Metode untuk menambah skor.
     */
    public void addScore(int points) {
        score = score + points;
        updateScoreDisplay();
    }
    
    /**
     * Metode untuk memperbarui tampilan skor di layar.
     */
    private void updateScoreDisplay() {
        // Hapus teks lama dengan menggambar kotak warna background di atasnya
        getBackground().setColor(new Color(66, 70, 77)); // Warna background Arena.jpg (perkiraan)
        getBackground().fillRect(LEBAR - 200, 10, 180, 40);
        
        // Tampilkan teks skor yang baru
        getBackground().setColor(Color.WHITE);
        getBackground().drawString("Skor: " + score, LEBAR - 150, 30);
    }
}
